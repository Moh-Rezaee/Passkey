{"version":3,"file":"index.js","sources":["../../../../src/screens/login-id/index.ts"],"sourcesContent":["import { BaseContext } from '../../models/base-context';\nimport { ScreenIds } from '../../utils/enums';\nimport { Errors } from '../../utils/errors';\nimport { FormHandler } from '../../utils/form-handler';\nimport { getPasskeyCredentials } from '../../utils/passkeys';\n\nimport { ScreenOverride } from './screen-override';\nimport { TransactionOverride } from './transaction-override';\n\nimport type { CustomOptions } from '../../../interfaces/common';\nimport type { ScreenContext } from '../../../interfaces/models/screen';\nimport type { TransactionContext } from '../../../interfaces/models/transaction';\nimport type {\n  ScreenMembersOnLoginId as ScreenOptions,\n  TransactionMembersOnLoginId as TransactionOptions,\n  LoginIdMembers,\n  LoginOptions,\n  SocialLoginOptions,\n} from '../../../interfaces/screens/login-id';\nimport type { FormOptions } from '../../../interfaces/utils/form-handler';\n\nexport default class LoginId extends BaseContext implements LoginIdMembers {\n  static screenIdentifier: string = ScreenIds.LOGIN_ID;\n  screen: ScreenOptions;\n  transaction: TransactionOptions;\n\n  /**\n   * Creates an instance of LoginIdManager.\n   */\n  constructor() {\n    super();\n\n    const screenContext = this.getContext('screen') as ScreenContext;\n    const transactionContext = this.getContext('transaction') as TransactionContext;\n\n    // Add the properties specific to the prompt.\n    this.screen = new ScreenOverride(screenContext);\n    this.transaction = new TransactionOverride(transactionContext);\n  }\n\n  /**\n   * @example\n   *\n   * import LoginId from \"@auth0/auth0-acul-js/login-id\";\n   *\n   * const loginIdManager = new LoginId();\n   *\n   * loginIdManager.login({\n   *   username: <usernameFieldValue>\n   * });\n   */\n  async login(payload: LoginOptions): Promise<void> {\n    const options: FormOptions = {\n      state: this.transaction.state,\n      telemetry: [LoginId.screenIdentifier, 'login'],\n    };\n\n    await new FormHandler(options).submitData<LoginOptions>(payload);\n  }\n\n  /**\n   * @example\n   * import LoginId from \"@auth0/auth0-acul-js/login-id\";\n   * const loginIdManager = new LoginId();\n   *\n   * // Check if alternateConnections is available and has at least one item\n   * if (!loginIdManager.transaction.alternateConnections) {\n   *   console.error('No alternate connections available.');\n   * }\n   *\n   * // Select the first available connection (users can select any available connection)\n   * const selectedConnection = alternateConnections[0];\n   *\n   * // Log the chosen connection for debugging or informational purposes\n   * console.log(`Selected connection: ${selectedConnection.name}`);\n   *\n   * // Proceed with federated login using the selected connection\n   * loginIdManager.socialLogin({\n   *   connection: selectedConnection.name,\n   * });\n   */\n  async socialLogin(payload: SocialLoginOptions): Promise<void> {\n    const options: FormOptions = {\n      state: this.transaction.state,\n      telemetry: [LoginId.screenIdentifier, 'socialLogin'],\n    };\n\n    await new FormHandler(options).submitData<SocialLoginOptions>(payload);\n  }\n\n  /**\n   * @example\n   * import LoginId from \"@auth0/auth0-acul-js/login-id\";\n   * const loginIdManager = new LoginId();\n   *\n   * // It internally maps users available passkey config provided from auth0 server\n   * loginIdManager.passkeyLogin();\n   */\n  async passkeyLogin(payload?: CustomOptions): Promise<void> {\n    const publicKey = this.screen.publicKey;\n    if (!publicKey) throw new Error(Errors.PASSKEY_DATA_UNAVAILABLE);\n\n    const passkey = await getPasskeyCredentials(publicKey);\n    const options: FormOptions = {\n      state: this.transaction.state,\n      telemetry: [LoginId.screenIdentifier, 'passkeyLogin'],\n    };\n\n    await new FormHandler(options).submitData<CustomOptions>({\n      ...payload,\n      passkey: JSON.stringify(passkey),\n    });\n  }\n\n  /**\n   * @example\n   * import LoginId from \"@auth0/auth0-acul-js/login-id\";\n   * const loginIdManager = new LoginId();\n   *\n   * loginIdManager.pickCountryCode();\n   */\n  async pickCountryCode(payload?: CustomOptions): Promise<void> {\n    const options: FormOptions = {\n      state: this.transaction.state,\n      telemetry: [LoginId.screenIdentifier, 'pickCountryCode'],\n    };\n\n    await new FormHandler(options).submitData<CustomOptions>({\n      ...payload,\n      action: 'pick-country-code',\n    });\n  }\n}\n\nexport {\n  LoginIdMembers,\n  LoginOptions,\n  SocialLoginOptions,\n  ScreenOptions as ScreenMembersOnLoginId,\n  TransactionOptions as TransactionMembersOnLoginId,\n};\nexport * from '../../../interfaces/export/common';\nexport * from '../../../interfaces/export/base-properties';\n"],"names":["LoginId","BaseContext","static","ScreenIds","LOGIN_ID","screen","transaction","constructor","super","screenContext","this","getContext","transactionContext","ScreenOverride","TransactionOverride","login","payload","options","state","telemetry","screenIdentifier","FormHandler","submitData","socialLogin","passkeyLogin","publicKey","Error","Errors","PASSKEY_DATA_UNAVAILABLE","passkey","getPasskeyCredentials","JSON","stringify","pickCountryCode","action"],"mappings":"2YAqBqB,MAAAA,UAAgBC,EACnCC,wBAAkCC,EAAUC,SAC5CC,OACAC,YAKA,WAAAC,GACEC,QAEA,MAAMC,EAAgBC,KAAKC,WAAW,UAChCC,EAAqBF,KAAKC,WAAW,eAG3CD,KAAKL,OAAS,IAAIQ,EAAeJ,GACjCC,KAAKJ,YAAc,IAAIQ,EAAoBF,GAc7C,WAAMG,CAAMC,GACV,MAAMC,EAAuB,CAC3BC,MAAOR,KAAKJ,YAAYY,MACxBC,UAAW,CAACnB,EAAQoB,iBAAkB,gBAGlC,IAAIC,EAAYJ,GAASK,WAAyBN,GAwB1D,iBAAMO,CAAYP,GAChB,MAAMC,EAAuB,CAC3BC,MAAOR,KAAKJ,YAAYY,MACxBC,UAAW,CAACnB,EAAQoB,iBAAkB,sBAGlC,IAAIC,EAAYJ,GAASK,WAA+BN,GAWhE,kBAAMQ,CAAaR,GACjB,MAAMS,EAAYf,KAAKL,OAAOoB,UAC9B,IAAKA,EAAW,MAAM,IAAIC,MAAMC,EAAOC,0BAEvC,MAAMC,QAAgBC,EAAsBL,GACtCR,EAAuB,CAC3BC,MAAOR,KAAKJ,YAAYY,MACxBC,UAAW,CAACnB,EAAQoB,iBAAkB,uBAGlC,IAAIC,EAAYJ,GAASK,WAA0B,IACpDN,EACHa,QAASE,KAAKC,UAAUH,KAW5B,qBAAMI,CAAgBjB,GACpB,MAAMC,EAAuB,CAC3BC,MAAOR,KAAKJ,YAAYY,MACxBC,UAAW,CAACnB,EAAQoB,iBAAkB,0BAGlC,IAAIC,EAAYJ,GAASK,WAA0B,IACpDN,EACHkB,OAAQ"}